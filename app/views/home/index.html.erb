<h1 class="invisible"><%= title "ホーム" %></h1>
<div class="flex justify-center items-center">
  <%= image_tag "title_logo.svg", alt: "タイトル", class: "inline-block h-15 object-contain" %>
</div>
<%= render "layouts/outline" %>

<section class="mb-8">
  <h2 class="invisible">計算の条件</h2>
  <div class="max-w-80 mx-auto">
    <%= form_with method: :get, data: { turbo_frame: "chart_and_list", controller: "timezone session-storage" } do |f| %>
      <div class="grid grid-cols-1 gap-0.5">
        <%= f.label :location, "地点" %>
        <%= f.select :location,
              [ [ "稚内", "WAKKANAI" ], [ "根室", "NEMURO" ], [ "小樽", "OTARU" ], [ "秋田", "AKITA" ], [ "相馬", "SOMA" ], [ "東京", "TOKYO" ], [ "富山", "TOYAMA" ], [ "名古屋", "NAGOYA" ], [ "明石", "AKASHI" ], [ "境港", "SAKAIMINATO" ], [ "土佐清水", "TOSASHIMIZU" ], [ "博多", "HAKATA" ], [ "種子島", "TANEGASHIMA" ], [ "那覇", "NAHA" ], [ "与那国島", "YONAGUNIJIMA" ], [ "父島", "CHICHIJIMA" ], [ "南鳥島", "MINAMITORISHIMA" ] ],
              { selected: @conditions[:location] }, data: { session_storage_target: "locationSelect" }, class: "mb-2 py-1.5 border rounded-sm" %>
        <p>期間</p>
        <div class="flex justify-between items-center mb-4">
          <%= f.date_field :first_date, data: { session_storage_target: "firstDateField" }, min: "2020-01-01", max: "2029-12-31", value: @conditions[:first_date], class: "grow-1 max-w-36 py-1.5 border rounded-sm" %>
          <span class="mx-4">〜</span>
          <%= f.date_field :last_date, data: { session_storage_target: "lastDateField" }, min: "2020-01-01", max: "2029-12-31", value: @conditions[:last_date], class: "grow-1 max-w-36 py-1.5 border rounded-sm" %>
        </div>
        <%= f.hidden_field :timezone, data: { timezone_target: "timezoneField" } %>
        <div class="text-center">
          <%= f.submit "グラフ・表#{ user_signed_in? ? "・メモ" : "" }を更新", { id: "display_button", data: { action: "click->timezone#setValue click->session-storage#setItem" },
                class: "px-4 h-10 transition-colors bg-indigo-600 font-medium text-white shadow-xs rounded-sm hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600" } %>
        </div>
      </div>
    <% end %>
  </div>
</section>

<%= turbo_frame_tag "chart_and_list" do %>
  <section class="text-center mb-6 sm:mb-10">
    <h2 class="text-lg font-semibold text-blue-900">
      ｢起潮力(垂直方向)｣と｢木星との距離｣
      <%= link_to image_tag("link-help.svg", alt: "補足説明へのリンク"), about_index_path, data: { turbo: false }, class: "inline-flex align-[-3px] link-primary" %>
    </h2>
    <div id="chart_vertical" class="h-96 w-full">
      <%= render "chart_vertical" %>
    </div>
  </section>

  <section class="text-center mb-6">
    <details>
      <summary class="mx-auto max-w-162 cursor-pointer">
        <h2 class="inline text-lg font-semibold text-blue-900">
          起潮力(水平方向) の｢強さ｣と｢方位角｣
          <%= link_to image_tag("link-help.svg", alt: "補足説明へのリンク"), about_index_path, data: { turbo: false }, class: "inline-flex align-[-3px] link-primary" %>
        </h2>
      </summary>
      <div>
        方位角（Azimuth）は、北が0度（360度）、東が90度、南が180度、西が270度です。
      </div>
      <div id="chart_horizontal" class="h-96 w-full">
        <%= render "chart_horizontal" %>
      </div>
    </details>
  </section>

  <%= tag.div data: { controller: "calc-results-page #{ user_signed_in? ? "records-page" : "" }" }, class: "max-w-270 mx-auto text-center" do %>
    <div class="inline-flex max-w-full overflow-x-auto">
      <section class="flex-1 overflow-x-auto">
        <h2 class="sticky left-0 text-nowrap text-lg font-semibold text-blue-900">結果一覧</h2>
        <div>
          <%= render "calc_results" %>
        </div>
      </section>
      <% if user_signed_in? %>
        <section class="flex-3 overflow-x-auto border-l md:flex-4 lg:flex-5 xl:flex-6">
          <h2 class="sticky left-0 text-lg font-semibold text-blue-900">メモ</h2>
          <div class="h-261">
            <div class="flex h-20 divide-x-tr">
              <div class="grid grid-rows-3 flex-none items-center justify-center border-b-thead">
                <div class="row-span-2 row-start-2 w-time">time</div>
              </div>
              <div class="grid grid-cols-6 w-records flex-none gap-0.5 pl-0.5 border-b-thead divide-x-tr">
                <%= render partial: "record_titles/record_title", collection: @record_titles %>
              </div>
              <div class="flex">
                <div class="grid grid-rows-3 flex-none justify-center items-center border-b-thead">
                  <div class="row-span-2 row-start-2 w-memo">memo</div>
                </div>
                <div class="w-record-links border-b-thead"></div>
              </div>
            </div>
            <div>
              <%= turbo_frame_tag "records" do %>
                <%= render partial: "records/record", collection: @records %>
              <% end %>
            </div>
          </div>
        </section>
      <% end %>
    </div>
    <div class="sticky bottom-0 bg-white">
      <%= render "pagination" %>
      <% if user_signed_in? %>
        <%= form_with method: :get, data: { records_page_target: "pageForm", turbo_frame: "records" } do |f| %>
          <%= f.hidden_field :page_id, data: { records_page_target: "pageField" } %>
        <% end %>
      <% end %>
    </div>
  <% end %>
<% end %>

<aside id="terms_and_privacy" class="mt-8">
  <%= render "layouts/terms_and_privacy" %>
</aside>
